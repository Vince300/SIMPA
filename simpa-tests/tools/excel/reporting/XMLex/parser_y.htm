<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0035)http://www.w3.org/XML/9707/parser.y -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="MSHTML 6.00.2800.1400" name=GENERATOR></HEAD>
<BODY><PRE>%{
/*
 * WARNING: This is not an XML 1.0 parser, but an experiment with an XML-like
 * language. See http://www.w3.org/XML/9707/XML-in-C
 *
 * Author: Bert Bos &lt;bert@w3.org&gt;
 * Created: 9 July 1997
 *
 * Copyright © 1997-2004 World Wide Web Consortium
 * See http://www.w3.org/Consortium/Legal/copyright-software-19980720.html
 */

#include &lt;string.h&gt;

extern char yytext[];
%}

%union {char *s;}

%token VERSION ATTDEF ENDDEF EQ SLASH CLOSE END
%token &lt;s&gt; ENCODING NAME VALUE DATA COMMENT START
%type &lt;s&gt; name_opt

%%

document
 : prolog element misc_seq_opt
 ;
prolog
 : version_opt encoding_opt
   misc_seq_opt
 ;
version_opt
 : VERSION			{printf("&lt;?XML-VERSION 1.0?&gt;\n");}
 | /*empty*/
 ;
encoding_opt
 : ENCODING			{printf("&lt;?XML-ENCODING %s?&gt;\n",$1); free($1);}
 | /*empty*/
 ;
misc_seq_opt
 : misc_seq_opt misc
 | /*empty*/
 ;
misc
 : COMMENT			{printf("%s", $1);}
 | attribute_decl
 ;
attribute_decl
 : ATTDEF NAME			{printf("\n&lt;?XML-ATT %s", $2);}
   attribute_seq_opt ENDDEF	{printf("?&gt;\n");}
 ;	
element
 : START			{printf("\n&lt;%s", $1); free($1);}
   attribute_seq_opt
   empty_or_content
 ;
empty_or_content
 : SLASH CLOSE			{printf("/&gt;\n");}
 | CLOSE			{printf("&gt;\n");}
   content END name_opt CLOSE	{printf("\n&lt;/%s&gt;\n", $5); free($5);}
 ;
content
 : content DATA			{printf("%s", $2); free($2);}
 | content misc
 | content element
 | /*empty*/
 ;
name_opt
 : NAME				{$$ = $1;}
 | /*empty*/			{$$ = strdup("");}
 ;
attribute_seq_opt
 : attribute_seq_opt attribute
 | /*empty*/
 ;
attribute
 : NAME				{printf(" %s", $1); free($1);}
 | NAME EQ VALUE		{printf(" %s=%s", $1, $3); free($1); free($3);}
 ;

</PRE></BODY></HTML>
